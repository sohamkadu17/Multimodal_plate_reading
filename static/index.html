<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Multimodal Plate Reader ‚Äî Demo</title>

  <!-- Bootstrap CSS (CDN) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom styles -->
  <link rel="stylesheet" href="css/styles.css">
</head>

<body>
  <nav class="navbar navbar-dark bg-dark mb-4">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Multimodal Plate Reader</a>
      <span class="text-muted small">Upload image / video / audio ‚Üí Analyze</span>
    </div>
  </nav>

  <main class="container">
    <div class="row g-4">
      <!-- Upload card -->
      <div class="col-lg-6">
        <div class="card shadow-sm">
          <div class="card-body">
            <h5 class="card-title">Upload Inputs</h5>
            <p class="text-muted">You can upload an image, optional video, and optional engine sound. Supported formats: JPG/PNG, MP4, WAV/MP3.</p>

            <form id="uploadForm" class="row g-3">
              <div class="col-12">
                <label class="form-label">Vehicle Image <span class="text-danger">*</span></label>
                <input id="imageInput" class="form-control" type="file" accept="image/*" required>
                
                <div class="form-text">High-quality images improve OCR accuracy.</div>
              </div>
              <div class="mt-2">
    <button id="openCameraBtn" type="button" class="btn btn-secondary btn-sm mt-2">
    üì∑Use Camera
</button>

</div>


              <div class="col-12">
                <label class="form-label">Vehicle Video (optional)</label>
                <input id="videoInput" class="form-control" type="file" accept="video/*">
                <div class="form-text">Short clip (<= 30s) for motion estimation.</div>
                <div class="mt-2">
    <button id="recordVideoBtn" type="button" class="btn btn-secondary btn-sm">
        üé• Record Video
    </button>

    <button id="stopVideoBtn" type="button" class="btn btn-danger btn-sm" style="display:none;">
        ‚èπ Stop Recording
    </button>
</div>

    
</div>
<div class="col-12">
                <label class="form-label">Engine Sound Audio (optional)</label>
                <input id="audioInput" class="form-control" type="file" accept="audio/*">
                <div class="form-text">.wav or .mp3 recommended.</div>
                <div class="mt-2">
    <button id="recordAudioBtn" type="button" class="btn btn-secondary btn-sm">
        üéô Record Audio
    </button>
    <button id="stopAudioBtn" type="button" class="btn btn-danger btn-sm" style="display:none;">
        ‚èπ Stop Recording
    </button>
</div>

              </div>

              <div class="col-12">
                <label class="form-label">Additional Notes</label>
                <textarea id="notes" class="form-control" rows="2" placeholder="Optional: e.g., location, suspected issue..."></textarea>
              </div>

              <div class="col-12 d-flex gap-2">
                <button id="analyzeBtn" type="button" class="btn btn-primary">Analyze</button>
                <button id="resetBtn" type="button" class="btn btn-outline-secondary">Reset</button>
                <div id="loading" class="ms-auto align-self-center" style="display:none;">
                  <div class="spinner-border spinner-border-sm" role="status"><span class="visually-hidden">Loading...</span></div>
                  <small class="text-muted ms-2">Analyzing...</small>
                </div>
              </div>
            </form>

            <hr>

            <h6>Previews</h6>
            <div id="previewArea" class="d-flex flex-column gap-2">
              <img id="imgPreview" alt="Image preview" class="img-fluid rounded shadow-sm" style="max-height:240px; display:none;">
              <video id="videoPreview" controls style="max-height:240px; display:none;" class="rounded shadow-sm"></video>
              <audio id="audioPreview" controls style="display:none;"></audio>
            </div>
          </div>
        </div>
      </div>

      <!-- Results card -->
      <div class="col-lg-6">
        <div class="card shadow-sm">
          <div class="card-body">
            <h5 class="card-title">Analysis Results</h5>
            <div id="results" class="mt-3">
              <p class="text-muted">No analysis performed yet.</p>
            </div>
            <hr>
            <h6>Raw JSON</h6>
            <pre id="rawJson" class="small bg-light p-2 rounded" style="max-height:300px; overflow:auto;">{}</pre>
            <div class="mt-3">
              <a id="downloadBtn" class="btn btn-outline-success btn-sm" href="#" download="analysis_result.json" style="display:none;">Download JSON</a>
            </div>
          </div>
        </div>

        <div class="mt-3 text-muted small">
          <strong>Notes:</strong> This frontend posts to <code>/analyze</code> as <code>multipart/form-data</code>. Ensure your backend route accepts files: <code>image</code>, <code>video</code>, <code>audio</code>, and fields: <code>notes</code>.
        </div>
      </div>
    </div>
  </main>

  <!-- Bootstrap JS (bundle) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <!-- CAMERA MODAL -->
  <div id="cameraModal" style="
    display:none;
    position: fixed;
    inset: 0;
    background: rgba(244, 238, 245, 0.7);
    justify-content: center;
    align-items: center;
    z-index: 1000;
  ">
    <div style="background:rgb(241, 235, 241); padding:20px; border-radius:10px; text-align:center;">
        <video id="cameraStream" autoplay playsinline style="width:300px; border-radius:10px;"></video>
        <br><br>
        <button id="captureBtn" class="btn btn-primary btn-sm">Capture</button>
        <button id="closeCameraBtn" class="btn btn-danger btn-sm">Close</button>
    </div>
  </div>

</div>

              


  <!-- App JS -->
  <script src="js/app.js"></script>
</body>
</html>
